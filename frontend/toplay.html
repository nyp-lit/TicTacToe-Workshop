<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Customizable Tic-Tac-Toe</title>
  <link rel="stylesheet" href="toplay.css" />
</head>

<body>

  <!-- Top Branding -->
  <div class="top-bar">
    <img src="logo.png" alt="Logo" style="max-height: 60px; margin-left: 20px;" />
  </div>
  <div class="header">Tic-Tac-Toe</div>

  <!-- Player setup and color selection -->
  <div class="player-setup">
    <!-- Player 1 Input -->
    <input type="text" id="player1" placeholder="Player 1 Name (X)" />
    <button class="btn btn-player1">Set Player 1</button><br />

    <!-- Player 2 Input -->
    <input type="text" id="player2" placeholder="Player 2 Name (O)" />
    <button class="btn btn-player2">Set Player 2</button><br />

    <!-- Color Pickers -->
    <div class="color-picker">
      <label for="xColor">X Color: </label>
      <input type="color" id="xColor" value="#E66EBB" />

      <label for="oColor">O Color: </label>
      <input type="color" id="oColor" value="#3881FF" />

      <label for="boardColor">Board Background: </label>
      <input type="color" id="boardColor" value="#4A10A2" />
    </div>

    <!-- Game control buttons -->
    <button class="btn btn-start">Start Game</button>
    <button class="btn btn-reset">Reset Game</button>
    <button class="btn btn-scoreboard">Restart Scoreboard</button>
  </div>

  <!-- Scoreboard -->
  <div class="scoreboard">
    <h3>Scoreboard</h3>
    <p id="scoreX">Player 1 (X): 0</p>
    <p id="scoreO">Player 2 (O): 0</p>
  </div>

  <!-- Game board container -->
  <div class="game-board" id="board"></div>

  <!-- Navigation buttons -->
  <button class="btn btn-nav" onclick="location.href='coverpage.html'">Back to Menu</button>
  <button class="btn btn-nav" onclick="location.href='instructions.html'">How to Play</button>

  <!-- Scripts -->
  <!-- Important to establish connections to socket.io for backend  -->
<script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
<script>
  // Do not delete, important to establish the connection: 
  const socket = io("http://localhost:3000");

  // Board
  const boardEl = document.getElementById("board");
  const scoreXEl = document.getElementById("scoreX");
  const scoreOEl = document.getElementById("scoreO");

  let board = Array(9).fill("");
  let currentPlayer = "X";
  let gameActive = false;
  let players = { X: "Player 1", O: "Player 2" };
  let scores = { X: 0, O: 0 };

  // Rendering of board
  function renderBoard() {
    boardEl.innerHTML = "";
    const xColor = document.getElementById("xColor").value;
    const oColor = document.getElementById("oColor").value;
    const boardBg = document.getElementById("boardColor").value;

    board.forEach((cell, i) => {
      const cellEl = document.createElement("div");
      cellEl.className = "cell";
      cellEl.textContent = cell;
      cellEl.style.backgroundColor = boardBg;
      cellEl.style.color = cell === "X" ? xColor : cell === "O" ? oColor : "#000";
      cellEl.onclick = () => {
        if (gameActive && board[i] === "") {
          console.log(`Player ${currentPlayer} clicked cell ${i}`);
          // socket.emit("cellClick", i);
        }
      };
      boardEl.appendChild(cellEl);
    });
  }

  function updateScoreDisplay() {
    scoreXEl.textContent = `${players.X} (X): ${scores.X}`;
    scoreOEl.textContent = `${players.O} (O): ${scores.O}`;
    console.log("Score updated:", scores);
  }

  // Event handlers for color updates
  document.getElementById("xColor").addEventListener("input", renderBoard);
  document.getElementById("oColor").addEventListener("input", renderBoard);
  document.getElementById("boardColor").addEventListener("input", renderBoard);

  // Player name setting
  function setPlayer(num) {
    const input = document.getElementById(`player${num}`);
    const symbol = num === 1 ? "X" : "O";
    const name = input.value || `Player ${num}`;
    players[symbol] = name;
    console.log(`Player ${symbol} set to "${name}"`);
    // socket.emit("setPlayer", { symbol, name }); 
    updateScoreDisplay();
  }

  document.querySelector(".btn-player1").addEventListener("click", () => setPlayer(1));
  document.querySelector(".btn-player2").addEventListener("click", () => setPlayer(2));
  document.querySelector(".btn-start").addEventListener("click", () => {
    console.log("Start Game button clicked");
    // socket.emit("startGame");
  });
  document.querySelector(".btn-reset").addEventListener("click", () => {
    console.log("Reset Game button clicked");
    // socket.emit("resetGame");
  });
  document.querySelector(".btn-scoreboard").addEventListener("click", () => {
    console.log("Reset Scoreboard button clicked");
    // socket.emit("restartScoreboard");
  });

// Backend: Add code that establish the connections 

  // Initial render
  renderBoard();
</script>

</body>
</html>
